import{a as h,u as g,b as x,r as j,j as s,P as v,d as b}from"./index-3uufXZXE.js";import{u as w}from"./index.esm-D9Zifrdc.js";function L(){const o=h(),{user:i,isLoading:r,error:t}=g(a=>a.user),l=x(),{register:n,handleSubmit:c,watch:d,formState:{errors:e,isValid:u}}=w({mode:"onBlur",defaultValues:{name:"",email:"",password:"",confirm:""}});j.useEffect(()=>{i!=null&&i.id&&l("/")},[i==null?void 0:i.id]);const p=a=>{if(a.confirm!==a.password)return;const{confirm:y,...f}=a;o(b(f)).unwrap().then(()=>l("/")).catch(m=>{m instanceof Error&&console.log(m.message)})};return r?s.jsx(v,{}):s.jsxs("form",{onSubmit:a=>void c(p)(a),className:"d-flex flex-column align-items-center",children:[s.jsx("h2",{className:"display-6 mb-4 mt-4",children:"Регистрация"}),s.jsxs("label",{htmlFor:"name-input",children:["Ваше имя",s.jsx("input",{className:`form-control  ${e.name?"is-invalid":""}`,...n("name",{required:"Введите имя",minLength:{value:3,message:"Минимум три символа"}})})]}),(e==null?void 0:e.name)&&s.jsx("div",{style:{color:"red"},children:(e==null?void 0:e.name.message)||"Error"}),s.jsxs("label",{htmlFor:"email-input",children:["Ваш email",s.jsx("input",{className:`form-control ${e.email?"is-invalid":""}`,...n("email",{required:"Введите email",minLength:{value:4,message:"Минимум четыре символа"},pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Некорректный email"}})})]}),(e==null?void 0:e.email)&&s.jsx("div",{style:{color:"red"},children:(e==null?void 0:e.email.message)||"Error"}),s.jsxs("label",{htmlFor:"password-input",children:["Пароль",s.jsx("input",{className:`form-control ${e.password?"is-invalid":""}`,type:"password",...n("password",{required:"Введите пароль",minLength:{value:3,message:"Минимум три символа"}})})]}),(e==null?void 0:e.password)&&s.jsx("div",{style:{color:"red"},children:(e==null?void 0:e.password.message)||"Error"}),s.jsxs("label",{htmlFor:"confirm-input",children:["Повторите пароль",s.jsx("input",{className:`form-control ${e.confirm?"is-invalid":""}`,type:"password",...n("confirm",{required:"Повторите пароль",validate:a=>{if(d("password")!==a)return"Пароли не совпадают"},minLength:{value:3,message:"Минимум три символа"}})})]}),(e==null?void 0:e.confirm)&&s.jsx("div",{style:{color:"red"},children:(e==null?void 0:e.confirm.message)||"Error"}),t&&s.jsx("div",{className:"alert alert-danger mt-3",children:t}),s.jsx("button",{type:"submit",className:"btn btn-outline-primary mt-3",disabled:!u,children:"Отправить"})]})}export{L as default};
